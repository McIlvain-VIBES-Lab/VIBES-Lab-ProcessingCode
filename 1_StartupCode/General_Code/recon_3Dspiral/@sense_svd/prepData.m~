 function vo = prepData(a, vi)
%	MRI "forward projection" y=A*x and backprojection x = (A')*y

if a.is.empty
	error empty
end

AA = a.A;
%sen = a.VS;
V = a.V;
num_coils = a.num_coils; %size(sen,2);  % NOTE THIS IS RANK oF SVD Combination
rank_svd = a.rank_svd;
nn = size(AA);
nx = nn(1);
ny = nn(2);


if (size(vi,1) ~= (num_coils*nx))
   sprintf('Error in prepData for coil combination SVD: sense_svd \n')
   return
end

        vi = reshape(vi,[nx num_coils]);

        vo = zeros(nx,rank_svd);
        for ii = 1:rank_svd
            temp = zeros(nx,1);
            for jj = 1:num_coils
                 temp = temp + V(ii,jj)*vi(:,jj);
            end
            vo(:,ii) = temp;
        end

        vo = vo(:);

       
